<script>
	import { MarkerClusterer } from "@googlemaps/markerclusterer";

	let map;

	function getRandomUSCoordinate() {
		// Define latitude and longitude ranges for the United States
		const minLatitude = 26.396308; // Southernmost point
		const maxLatitude = 48.384358; // Northernmost point
		const minLongitude = -123.295595; // Westernmost point
		const maxLongitude = -75.93457; // Easternmost point

		// Generate random latitude and longitude values within the defined ranges
		const randomLatitude =
			Math.random() * (maxLatitude - minLatitude) + minLatitude;
		const randomLongitude =
			Math.random() * (maxLongitude - minLongitude) + minLongitude;

		// Return the random coordinate as an object
		return {
			latitude: randomLatitude,
			longitude: randomLongitude,
		};
	}

	// Sorry, @types/googlemaps didn't work as it was missing importLibrary
	declare var google: { maps: any };

	async function initMap() {
		const { Map } = await google.maps.importLibrary("maps");

		const markers = [];
		map = new Map(document.getElementById("map"), {
			center: { lat: 39.741036, lng: -96.922359 },
			zoom: 4,
		});

		for (var i = 0; i < 100; i++) {
			const location = getRandomUSCoordinate();

			var latLng = new google.maps.LatLng(
				location.latitude,
				location.longitude
			);
			var marker = new google.maps.Marker({
				position: latLng,
			});
			markers.push(marker);
		}

		const markerCluster = new MarkerClusterer({ map, markers });
	}

	// initMap();
</script>
